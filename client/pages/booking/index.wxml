<view class="page">
    <block wx:if="{{booking}}">
        <view class="weui-panel weui-panel_access">
            <view class="weui-panel__hd">{{booking.deadline}}前来一杯</view>
            <view class="weui-panel__bd">
                <view class="weui-media-box weui-media-box_appmsg" wx:for="{{booking.participants}}" wx:key="{{user}}">
                    <view class="weui-media-box__hd weui-media-box__hd_in-appmsg">
                        <image class="weui-media-box__thumb" src="{{item.profile.avatarUrl}}" />
                    </view>
                    <view class="weui-media-box__bd weui-media-box__bd_in-appmsg">
                        <view class="weui-media-box__title">{{item.profile.nickName}}</view>
                        <view class="weui-media-box__desc">{{item.choice}}</view>
                    </view>
                </view>
            </view>
        </view>
    </block>

    <view class="weui-footer weui-footer_fixed-bottom">
        <block wx:if="{{booking && booking.status === 'created'}}">
            <block wx:if="{{!hasUserInfo}}">
                <button class="weui-btn" open-type="getUserInfo" type="primary" bindgetuserinfo="onAuthed">来一杯先</button>
            </block>
            <block wx:elif="{{!isMine}}">
                <view class="weui-cells weui-cells_after-title">
                    <view class="weui-cell weui-cell_access">
                        <view class="weui-cell__bd"><text>{{profile.preference || '暂无口味'}}</text></view>
                        <view class="weui-cell__ft weui-cell__ft_in-access" style="font-size: 0">
                            <view style="display: inline-block;vertical-align:middle; font-size: 17px;" bindtap="onChangePreference">换换口味</view>
                        </view>
                    </view>
                </view>
                <button class="weui-btn" type="primary" bindtap="onJoinBooking">算我一个</button>
            </block>
            <block wx:else>
                <button class="weui-btn" type="primary" bindtap="onEndBooking">收工了</button>
            </block>
        </block>
        <block wx:else>
            <button class="weui-btn" type="default" disabled="true" plain="true">已经结束了</button>
        </block>
    </view>
</view>